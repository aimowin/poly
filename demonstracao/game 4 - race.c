#include "poly/poly.h"
#include <math.h>
int fatorx[36]={9,8,7,6,5,4,3,2,1,0,-1,-2,-3,-4,-5,-6,-7,-8,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8};
int fatory[36]={0,-1,-2,-3,-4,-5,-6,-7,-8,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,8,7,6,5,4,3,2,1};
int pista[17][23]={{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0},{0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0},{0,0,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,1,1,1,1,1,0,1,1,1,1,1,0,0,0,0,0,0},{0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0},{0,0,0,0,0,0,1,1,1,1,1,0,1,1,1,1,1,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0},{0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0},{0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
int px,py,angulo;

void init(){
	px=1320;
	py=1136;
	angulo=0;
}

int main(){
	
	init();
	setvideomode();
	while(!keystate(KEY_ESCAPE)){
		setcolor(0);
		bar(0,0,320,200);
		//for(int x=0;x<17;x++)for(int y=0;y<23;y++)if(pista[x][y]!=0)bar(24+(12*y),0+(12*x),11,11);
		
		setcolor(21);
		for(int x=0;x<17;x++)for(int y=0;y<23;y++)if(pista[x][y]==1)bar(-px+(80*y),-py+(80*x),80,80);

		setcolor(17);
		int bordas[8]={
			160+(sin((((angulo+15)%36)*10)*0.0174)*14),100+(cos((((angulo+15)%36)*10)*0.0174)*14),
			160+(sin((((angulo+21)%36)*10)*0.0174)*14),100+(cos((((angulo+21)%36)*10)*0.0174)*14),
			160+(sin((((angulo+33)%36)*10)*0.0174)*14),100+(cos((((angulo+33)%36)*10)*0.0174)*14),
			160+(sin((((angulo+3)%36)*10)*0.0174)*14),100+(cos((((angulo+3)%36)*10)*0.0174)*14)
		};
		fillpoly(bordas,4);

		if(keystate(KEY_LEFT))angulo=(angulo+1)%36;
		if(keystate(KEY_RIGHT))angulo=(angulo+35)%36;

		if(py>-20&&pista[((py+20)/80)+1][(px/80)+2]==1){
			py-=fatorx[angulo];
			px+=fatory[angulo];
		}
		else init();

		sleep(30);

		waitvbl();
	}
	return 0;
}
